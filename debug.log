Logging initialized at 2025-10-02 18:15:15
2025-10-02 18:15:15,170 - INFO - Tier switched to: free
2025-10-02 18:15:15,784 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 18:15:15,785 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000002695BE2F770>
2025-10-02 18:15:15,787 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 18:15:16,644 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 18:15:16,645 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 18:15:16,707 - DEBUG - Using proactor: IocpProactor
2025-10-02 18:15:38,772 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'undefined', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'})
2025-10-02 18:15:38,772 - ERROR - CSRF validation failed: Provided=undefined, Expected=None
2025-10-02 18:15:38,772 - DEBUG - Flushing log file after CSRF validation failure
2025-10-02 18:15:38,772 - ERROR - CSRF verification error: 403: Invalid CSRF token
2025-10-02 18:15:38,773 - DEBUG - Flushing log file after CSRF verification error
2025-10-02 18:17:46,244 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=user1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'undefined', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'})
2025-10-02 18:17:46,244 - ERROR - CSRF validation failed: Provided=undefined, Expected=None
2025-10-02 18:17:46,244 - DEBUG - Flushing log file after CSRF validation failure
2025-10-02 18:17:46,244 - ERROR - CSRF verification error: 403: Invalid CSRF token
2025-10-02 18:17:46,244 - DEBUG - Flushing log file after CSRF verification error
2025-10-02 18:18:07,886 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=user%201, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'undefined', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'})
2025-10-02 18:18:07,886 - ERROR - CSRF validation failed: Provided=undefined, Expected=None
2025-10-02 18:18:07,886 - DEBUG - Flushing log file after CSRF validation failure
2025-10-02 18:18:07,886 - ERROR - CSRF verification error: 403: Invalid CSRF token
2025-10-02 18:18:07,886 - DEBUG - Flushing log file after CSRF verification error
Logging initialized at 2025-10-02 18:31:48
2025-10-02 18:31:48,936 - INFO - Tier switched to: free
2025-10-02 18:31:49,266 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 18:31:49,267 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001EE8648F8C0>
2025-10-02 18:31:49,268 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 18:31:49,862 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 18:31:49,863 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 18:31:49,908 - DEBUG - Using proactor: IocpProactor
Logging initialized at 2025-10-02 18:32:19
2025-10-02 18:32:19,728 - INFO - Tier switched to: free
2025-10-02 18:32:20,065 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 18:32:20,066 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001B8C3BAF8C0>
2025-10-02 18:32:20,067 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 18:32:20,652 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 18:32:20,653 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 18:32:20,698 - DEBUG - Using proactor: IocpProactor
2025-10-02 18:33:07,974 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 18:33:07,975 - DEBUG - Flushing log file after loading auth
2025-10-02 18:33:08,159 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'}
2025-10-02 18:33:08,159 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImFadWVuZDlnUkVnUEM1cFg1TkFjSUkyYzc3a19oc21ZdGFsZG9uY2p4aXcifQ==.aN8VKg.BHBp2UZNazHqHoOA1yHTqJlNvQA'})
2025-10-02 18:33:08,159 - INFO - Generated new CSRF token: n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ
2025-10-02 18:33:08,159 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:33:08,159 - INFO - Returning CSRF token: n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ
2025-10-02 18:33:08,159 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:33:55,960 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signup/testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '58', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8ZxA.xJt0teA93PCUbqh_QvEWCWzreVg'})
2025-10-02 18:33:55,960 - DEBUG - Flushing log file after CSRF verification
2025-10-02 18:33:56,199 - INFO - User testuser signed up with free tier
2025-10-02 18:33:56,199 - DEBUG - Flushing log file after signup
2025-10-02 18:33:57,226 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 18:33:57,227 - DEBUG - Flushing log file after loading UI
2025-10-02 18:33:57,279 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8Z9Q.MKPwcIVkiLeTq9xApavjSrwFBOc'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8Z9Q.MKPwcIVkiLeTq9xApavjSrwFBOc'}
2025-10-02 18:33:57,279 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8Z9Q.MKPwcIVkiLeTq9xApavjSrwFBOc'})
2025-10-02 18:33:57,279 - DEBUG - Reusing existing CSRF token: n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ
2025-10-02 18:33:57,279 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:33:57,279 - INFO - Returning CSRF token: n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ
2025-10-02 18:33:57,279 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:33:57,283 - DEBUG - Retrieved tier for testuser: free
2025-10-02 18:33:57,283 - DEBUG - Flushing log file after tier retrieval
2025-10-02 18:34:31,537 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'undefined', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8aEQ.e13LJfZ3DiskBqc4px1iV4LqSYo'})
2025-10-02 18:34:31,537 - ERROR - CSRF validation failed: Provided=undefined, Expected=n9N6dejuVDTCmLsfjGuwxKJcQdnmm0BRNkaWaVwANPQ
2025-10-02 18:34:31,537 - DEBUG - Flushing log file after CSRF validation failure
2025-10-02 18:34:31,537 - ERROR - CSRF verification error: 403: Invalid CSRF token
2025-10-02 18:34:31,537 - DEBUG - Flushing log file after CSRF verification error
2025-10-02 18:34:31,537 - ERROR - Reset usage HTTP error for testuser: 500: CSRF verification failed: 403: Invalid CSRF token
Logging initialized at 2025-10-02 18:43:57
2025-10-02 18:43:57,324 - INFO - Tier switched to: free
2025-10-02 18:43:57,657 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 18:43:57,657 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001C21AFBF8C0>
2025-10-02 18:43:57,659 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 18:43:58,262 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 18:43:58,262 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 18:43:58,308 - DEBUG - Using proactor: IocpProactor
2025-10-02 18:44:10,083 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 18:44:10,083 - DEBUG - Flushing log file after loading UI
2025-10-02 18:44:10,109 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8aFw.yNTJmTyanSfWgBnJrP2EItmaLKY'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8aFw.yNTJmTyanSfWgBnJrP2EItmaLKY'}
2025-10-02 18:44:10,110 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIm45TjZkZWp1VkRUQ21Mc2ZqR3V3eEtKY1Fkbm1tMEJSTmthV2FWd0FOUFEifQ==.aN8aFw.yNTJmTyanSfWgBnJrP2EItmaLKY'})
2025-10-02 18:44:10,110 - INFO - Generated new CSRF token: UwsU7CJyCWjdQt4QNmwhUluBRZXF-ZBtbmKrwjTnNKk
2025-10-02 18:44:10,110 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:44:10,110 - INFO - Returning CSRF token: UwsU7CJyCWjdQt4QNmwhUluBRZXF-ZBtbmKrwjTnNKk
2025-10-02 18:44:10,110 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:44:10,132 - DEBUG - Retrieved tier for testuser: free
2025-10-02 18:44:10,132 - DEBUG - Flushing log file after tier retrieval
2025-10-02 18:44:44,820 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'null', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlV3c1U3Q0p5Q1dqZFF0NFFObXdoVWx1QlJaWEYtWkJ0Ym1LcndqVG5OS2sifQ==.aN8cWg.ABxDdZU4HFmmr79rDkjEXP6t5Ew'})
2025-10-02 18:44:44,821 - ERROR - CSRF validation failed: Provided=null, Expected=UwsU7CJyCWjdQt4QNmwhUluBRZXF-ZBtbmKrwjTnNKk
2025-10-02 18:44:44,821 - DEBUG - Flushing log file after CSRF validation failure
2025-10-02 18:44:44,821 - ERROR - CSRF verification error: 403: Invalid CSRF token
2025-10-02 18:44:44,821 - DEBUG - Flushing log file after CSRF verification error
2025-10-02 18:44:44,821 - ERROR - Reset usage HTTP error for testuser: 500: CSRF verification failed: 403: Invalid CSRF token
Logging initialized at 2025-10-02 18:52:57
2025-10-02 18:52:57,535 - INFO - Tier switched to: free
2025-10-02 18:52:57,911 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 18:52:57,912 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x0000017525B9F8C0>
2025-10-02 18:52:57,913 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 18:52:58,505 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 18:52:58,506 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 18:52:58,554 - DEBUG - Using proactor: IocpProactor
2025-10-02 18:53:35,616 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 18:53:35,616 - DEBUG - Flushing log file after loading auth
2025-10-02 18:53:35,777 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlV3c1U3Q0p5Q1dqZFF0NFFObXdoVWx1QlJaWEYtWkJ0Ym1LcndqVG5OS2sifQ==.aN8cfA.VpN4YSf2oiC7aaQ94aLwlDAF7JY'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIlV3c1U3Q0p5Q1dqZFF0NFFObXdoVWx1QlJaWEYtWkJ0Ym1LcndqVG5OS2sifQ==.aN8cfA.VpN4YSf2oiC7aaQ94aLwlDAF7JY'}
2025-10-02 18:53:35,777 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlV3c1U3Q0p5Q1dqZFF0NFFObXdoVWx1QlJaWEYtWkJ0Ym1LcndqVG5OS2sifQ==.aN8cfA.VpN4YSf2oiC7aaQ94aLwlDAF7JY'})
2025-10-02 18:53:35,777 - INFO - Generated new CSRF token: E408FNEHIrxA8lW42rm8i7cZ74DCgMrOXNUIGpFkCic
2025-10-02 18:53:35,777 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:53:35,777 - INFO - Returning CSRF token: E408FNEHIrxA8lW42rm8i7cZ74DCgMrOXNUIGpFkCic
2025-10-02 18:53:35,777 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:53:43,538 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 18:53:43,538 - DEBUG - Flushing log file after loading UI
2025-10-02 18:53:43,556 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkU0MDhGTkVISXJ4QThsVzQycm04aTdjWjc0RENnTXJPWE5VSUdwRmtDaWMifQ==.aN8elw.gR4UbjPSkBhUi85He6-pOU8OVeg'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIkU0MDhGTkVISXJ4QThsVzQycm04aTdjWjc0RENnTXJPWE5VSUdwRmtDaWMifQ==.aN8elw.gR4UbjPSkBhUi85He6-pOU8OVeg'}
2025-10-02 18:53:43,556 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'E408FNEHIrxA8lW42rm8i7cZ74DCgMrOXNUIGpFkCic'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkU0MDhGTkVISXJ4QThsVzQycm04aTdjWjc0RENnTXJPWE5VSUdwRmtDaWMifQ==.aN8elw.gR4UbjPSkBhUi85He6-pOU8OVeg'})
2025-10-02 18:53:43,556 - DEBUG - Reusing existing CSRF token: E408FNEHIrxA8lW42rm8i7cZ74DCgMrOXNUIGpFkCic
2025-10-02 18:53:43,556 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:53:43,556 - INFO - Returning CSRF token: E408FNEHIrxA8lW42rm8i7cZ74DCgMrOXNUIGpFkCic
2025-10-02 18:53:43,556 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:53:43,570 - DEBUG - Retrieved tier for testuser: free
2025-10-02 18:53:43,570 - DEBUG - Flushing log file after tier retrieval
2025-10-02 18:54:02,766 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 18:54:02,767 - DEBUG - Flushing log file after loading auth
2025-10-02 18:54:02,857 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-02 18:54:02,858 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-02 18:54:02,858 - INFO - Generated new CSRF token: i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY
2025-10-02 18:54:02,858 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:54:02,858 - INFO - Returning CSRF token: i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY
2025-10-02 18:54:02,858 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:54:46,170 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signin/testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '27', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImkwbDc0eTdZa25uaU05anU0NjNHU1dpZ3lLQTZCVUZZZlU3RWRJSUtqa1kifQ==.aN8eqg.H99nPW9iOs9W-a3mfnyrgArOdtQ'})
2025-10-02 18:54:46,171 - DEBUG - Flushing log file after CSRF verification
2025-10-02 18:54:46,402 - INFO - User testuser signed in
2025-10-02 18:54:46,402 - DEBUG - Flushing log file after signin
2025-10-02 18:54:46,407 - DEBUG - Retrieved tier for testuser: free
2025-10-02 18:54:46,407 - DEBUG - Flushing log file after tier retrieval
2025-10-02 18:54:47,420 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 18:54:47,420 - DEBUG - Flushing log file after loading UI
2025-10-02 18:54:47,488 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImkwbDc0eTdZa25uaU05anU0NjNHU1dpZ3lLQTZCVUZZZlU3RWRJSUtqa1kifQ==.aN8e1w.U7cdvw_oFcGCqJgSS6a9Glf5vbc'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImkwbDc0eTdZa25uaU05anU0NjNHU1dpZ3lLQTZCVUZZZlU3RWRJSUtqa1kifQ==.aN8e1w.U7cdvw_oFcGCqJgSS6a9Glf5vbc'}
2025-10-02 18:54:47,488 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImkwbDc0eTdZa25uaU05anU0NjNHU1dpZ3lLQTZCVUZZZlU3RWRJSUtqa1kifQ==.aN8e1w.U7cdvw_oFcGCqJgSS6a9Glf5vbc'})
2025-10-02 18:54:47,488 - DEBUG - Reusing existing CSRF token: i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY
2025-10-02 18:54:47,488 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 18:54:47,488 - INFO - Returning CSRF token: i0l74y7YknniM9ju463GSWigyKA6BUFYfU7EdIIKjkY
2025-10-02 18:54:47,488 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 18:54:47,491 - DEBUG - Retrieved tier for testuser: free
2025-10-02 18:54:47,491 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-02 19:05:21
2025-10-02 19:05:21,136 - INFO - Tier switched to: free
2025-10-02 19:05:21,514 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 19:05:21,515 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000002751734B770>
2025-10-02 19:05:21,516 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 19:05:22,101 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 19:05:22,101 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 19:05:22,151 - DEBUG - Using proactor: IocpProactor
2025-10-02 19:05:54,534 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:05:54,534 - DEBUG - Flushing log file after loading UI
2025-10-02 19:05:54,639 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-02 19:05:54,639 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-02 19:05:54,639 - INFO - Generated new CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:05:54,639 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:05:54,640 - INFO - Returning CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:05:54,640 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:05:54,643 - DEBUG - Retrieved tier for anonymous: free
2025-10-02 19:05:54,643 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:06:03,307 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 19:06:03,307 - DEBUG - Flushing log file after loading auth
2025-10-02 19:06:03,407 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hew.FJAsjSntuj7YLZlso4LiDMvGztw'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hew.FJAsjSntuj7YLZlso4LiDMvGztw'}
2025-10-02 19:06:03,407 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hew.FJAsjSntuj7YLZlso4LiDMvGztw'})
2025-10-02 19:06:03,407 - DEBUG - Reusing existing CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:06:03,407 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:06:03,407 - INFO - Returning CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:06:03,407 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:06:23,871 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signin/testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '27', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hew.FJAsjSntuj7YLZlso4LiDMvGztw'})
2025-10-02 19:06:23,871 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:06:24,095 - INFO - User testuser signed in
2025-10-02 19:06:24,095 - DEBUG - Flushing log file after signin
2025-10-02 19:06:24,101 - DEBUG - Retrieved tier for testuser: free
2025-10-02 19:06:24,101 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:06:25,127 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:06:25,127 - DEBUG - Flushing log file after loading UI
2025-10-02 19:06:25,150 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hkQ.AC2nOJBNaFv2P6SQif7nUNW5BWE'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hkQ.AC2nOJBNaFv2P6SQif7nUNW5BWE'}
2025-10-02 19:06:25,150 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hkQ.AC2nOJBNaFv2P6SQif7nUNW5BWE'})
2025-10-02 19:06:25,150 - DEBUG - Reusing existing CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:06:25,150 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:06:25,150 - INFO - Returning CSRF token: lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM
2025-10-02 19:06:25,150 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:06:25,155 - DEBUG - Retrieved tier for testuser: free
2025-10-02 19:06:25,155 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:07:26,147 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8how.3iZg68oEYoM6eK15arz1CbJPV-4'})
2025-10-02 19:07:26,147 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:07:26,155 - INFO - Reset usage for testuser
2025-10-02 19:07:26,155 - INFO - Usage reset to 0 for testuser
2025-10-02 19:07:26,155 - DEBUG - Flushing log file after usage reset
2025-10-02 19:07:48,246 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'lha_wdKpULWbS1m0TsesoSrsAL7KkyvJyIuyREb2cxM', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImxoYV93ZEtwVUxXYlMxbTBUc2Vzb1Nyc0FMN0treXZKeUl1eVJFYjJjeE0ifQ==.aN8hzg.KTmlsBiuBIE15aXSMC4MAbY5I7c'})
2025-10-02 19:07:48,246 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:07:48,253 - INFO - Set tier for testuser to beginner
2025-10-02 19:07:48,253 - INFO - Upgraded testuser to beginner tier
2025-10-02 19:07:48,254 - DEBUG - Flushing log file after tier upgrade
2025-10-02 19:14:00,251 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:14:00,251 - DEBUG - Flushing log file after loading UI
2025-10-02 19:14:00,278 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-02 19:14:00,278 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-02 19:14:00,278 - INFO - Generated new CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:14:00,278 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:14:00,278 - INFO - Returning CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:14:00,278 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:14:00,282 - DEBUG - Retrieved tier for anonymous: free
2025-10-02 19:14:00,283 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:14:04,205 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 19:14:04,205 - DEBUG - Flushing log file after loading auth
2025-10-02 19:14:04,423 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8jXA.HQp7gF5RollkwKeEqLAHvkRovMo'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8jXA.HQp7gF5RollkwKeEqLAHvkRovMo'}
2025-10-02 19:14:04,423 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8jXA.HQp7gF5RollkwKeEqLAHvkRovMo'})
2025-10-02 19:14:04,423 - DEBUG - Reusing existing CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:14:04,423 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:14:04,423 - INFO - Returning CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:14:04,423 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:15:13,360 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8jiA.XiFIqNGjyIJN2anqC90iMZgv8yo'})
2025-10-02 19:15:13,361 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:15:13,368 - INFO - Reset usage for testuser
2025-10-02 19:15:13,368 - INFO - Usage reset to 0 for testuser
2025-10-02 19:15:13,368 - DEBUG - Flushing log file after usage reset
2025-10-02 19:17:02,973 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:17:02,973 - DEBUG - Flushing log file after loading UI
2025-10-02 19:17:02,997 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDg.llAb5bKHP7ciY3wmsn5q6YkicNY'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDg.llAb5bKHP7ciY3wmsn5q6YkicNY'}
2025-10-02 19:17:02,997 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDg.llAb5bKHP7ciY3wmsn5q6YkicNY'})
2025-10-02 19:17:02,997 - DEBUG - Reusing existing CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:17:02,997 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:17:02,997 - INFO - Returning CSRF token: kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w
2025-10-02 19:17:02,997 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:17:03,002 - DEBUG - Retrieved tier for anonymous: free
2025-10-02 19:17:03,002 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:21:17,613 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_value with data[63:117]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_end with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_field with data[119:131]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_value with data[133:157]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_end with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_part_data with data[161:652]
2025-10-02 19:21:17,613 - DEBUG - Calling on_part_end with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_field with data[696:715]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_value with data[717:751]
2025-10-02 19:21:17,613 - DEBUG - Calling on_header_end with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_part_end with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_header_field with data[799:818]
2025-10-02 19:21:17,614 - DEBUG - Calling on_header_value with data[820:851]
2025-10-02 19:21:17,614 - DEBUG - Calling on_header_end with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_part_end with no data
2025-10-02 19:21:17,614 - DEBUG - Calling on_end with no data
2025-10-02 19:21:17,615 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '901', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'kXcMuvnAhPueQHMDNZ543YyBdy9loLJi0jgMZmmaK1w', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundarybyvQu9VAOkxzEug0', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDw.5MCXeCp92-xEMxBqXaQfCE90eDo'})
2025-10-02 19:21:17,615 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:21:17,616 - DEBUG - File read: 491 bytes for user anonymous
2025-10-02 19:21:17,617 - INFO - UsageTracker incremented to: 1, current tier: free
2025-10-02 19:21:17,617 - INFO - Audit request 1 processed for contract None with tier free for user None
2025-10-02 19:21:17,617 - DEBUG - Flushing log file after audit request
[2025-10-02 19:21:17] Raw response logging attempt
2025-10-02 19:21:17,621 - INFO - 'solc --version' running
2025-10-02 19:21:18,868 - INFO - 'solc C:\Users\client\DeFiGuard\tmptz39z40j.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-02 19:21:19,075 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmptz39z40j.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmptz39z40j.sol




2025-10-02 19:21:19,088 - INFO - Slither analysis completed successfully.
2025-10-02 19:21:19,089 - INFO - Fuzzing skipped for free tier
2025-10-02 19:21:19,097 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found.\nFuzzing Results: [].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount, "Insufficient balance");\r\n        (bool sent, ) = msg.sender.call{value: amount}("");\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: free.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-02 19:21:19,216 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-02 19:21:19,216 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-02 19:21:19,303 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000275175DBE00>
2025-10-02 19:21:19,303 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000027517299270> server_hostname='api.x.ai' timeout=5.0
2025-10-02 19:21:19,347 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027517556C10>
2025-10-02 19:21:19,347 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-02 19:21:19,347 - DEBUG - send_request_headers.complete
2025-10-02 19:21:19,347 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-02 19:21:19,348 - DEBUG - send_request_body.complete
2025-10-02 19:21:19,348 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-02 19:21:43,628 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 03 Oct 2025 01:21:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-accf8096df7949bc4189be827842a63c-58db6dc10001860e-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=st4FOegT63IYY_QGJ5O6jDU.boHqh8ULto0yQebFcx8-1759454503-1.0.1.1-B5XchgFuD_Kxf4_TrGvdSde2PIAIutMP_0E7W9lTBKIdCXbL5MZZLmRkVh6aEVfF4QIzWYnf_ehVCQCU8gzP8aVi3YO242RqT4TcK3c4xXY; path=/; expires=Fri, 03-Oct-25 01:51:43 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98889f3feb68e757-DEN')])
2025-10-02 19:21:43,629 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-02 19:21:43,629 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-02 19:21:43,629 - DEBUG - receive_response_body.complete
2025-10-02 19:21:43,629 - DEBUG - response_closed.started
2025-10-02 19:21:43,629 - DEBUG - response_closed.complete
2025-10-02 19:21:43,629 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Fri, 03 Oct 2025 01:21:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-accf8096df7949bc4189be827842a63c-58db6dc10001860e-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=st4FOegT63IYY_QGJ5O6jDU.boHqh8ULto0yQebFcx8-1759454503-1.0.1.1-B5XchgFuD_Kxf4_TrGvdSde2PIAIutMP_0E7W9lTBKIdCXbL5MZZLmRkVh6aEVfF4QIzWYnf_ehVCQCU8gzP8aVi3YO242RqT4TcK3c4xXY; path=/; expires=Fri, 03-Oct-25 01:51:43 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '98889f3feb68e757-DEN'})
2025-10-02 19:21:43,630 - DEBUG - request_id: 00-accf8096df7949bc4189be827842a63c-58db6dc10001860e-01
[2025-10-02 19:21:17] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."},{"type":"Regulatory Compliance - MiCA 2025","severity":"Med","fix":"Ensure token classification and issuer requirements under MiCA for crypto-asset service providers."},{"type":"Regulatory Compliance - SEC FIT21 2025","severity":"Med","fix":"Assess if the token qualifies as a digital asset security and comply with registration or exemption rules."}],"predictions":[{"scenario":"An attacker exploits reentrancy to drain the contract's funds by repeatedly calling withdraw before balance update.","impact":"High"},{"scenario":"Non-compliance with MiCA could lead to legal penalties for operating without proper authorization in EU markets.","impact":"Med"},{"scenario":"Violation of SEC FIT21 might result in enforcement actions if the token is deemed a security without registration.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a thorough audit of the contract for other potential vulnerabilities.","Review and classify the token under MiCA regulations to ensure compliance with EU crypto-asset rules.","Evaluate the token against SEC FIT21 criteria to determine if it requires registration as a security.","Consider using established libraries like OpenZeppelin's ReentrancyGuard for added security."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:21:43,636 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."},{"type":"Regulatory Compliance - MiCA 2025","severity":"Med","fix":"Ensure token classification and issuer requirements under MiCA for crypto-asset service providers."},{"type":"Regulatory Compliance - SEC FIT21 2025","severity":"Med","fix":"Assess if the token qualifies as a digital asset security and comply with registration or exemption rules."}],"predictions":[{"scenario":"An attacker exploits reentrancy to drain the contract's funds by repeatedly calling withdraw before balance update.","impact":"High"},{"scenario":"Non-compliance with MiCA could lead to legal penalties for operating without proper authorization in EU markets.","impact":"Med"},{"scenario":"Violation of SEC FIT21 might result in enforcement actions if the token is deemed a security without registration.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a thorough audit of the contract for other potential vulnerabilities.","Review and classify the token under MiCA regulations to ensure compliance with EU crypto-asset rules.","Evaluate the token against SEC FIT21 criteria to determine if it requires registration as a security.","Consider using established libraries like OpenZeppelin's ReentrancyGuard for added security."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:21:43,639 - DEBUG - Flushing log file after successful audit
Logging initialized at 2025-10-02 19:33:54
2025-10-02 19:33:54,351 - INFO - Tier switched to: free
2025-10-02 19:33:54,694 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 19:33:54,694 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000002435A35B770>
2025-10-02 19:33:54,696 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 19:33:55,268 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 19:33:55,269 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 19:33:55,320 - DEBUG - Using proactor: IocpProactor
2025-10-02 19:34:22,378 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 19:34:22,379 - DEBUG - Flushing log file after loading auth
2025-10-02 19:34:22,499 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDw.5MCXeCp92-xEMxBqXaQfCE90eDo'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDw.5MCXeCp92-xEMxBqXaQfCE90eDo'}
2025-10-02 19:34:22,499 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImtYY011dm5BaFB1ZVFITUROWjU0M1l5QmR5OWxvTEppMGpnTVptbWFLMXcifQ==.aN8kDw.5MCXeCp92-xEMxBqXaQfCE90eDo'})
2025-10-02 19:34:22,499 - INFO - Generated new CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:34:22,499 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:34:22,499 - INFO - Returning CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:34:22,499 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:34:40,334 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signin/testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '27', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oHg.9iyP46ylA807jTWrfq1Lavnqw4s'})
2025-10-02 19:34:40,334 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:34:40,562 - INFO - User testuser signed in
2025-10-02 19:34:40,562 - DEBUG - Flushing log file after signin
2025-10-02 19:34:40,569 - DEBUG - Retrieved tier for testuser: beginner
2025-10-02 19:34:40,569 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:34:41,594 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:34:41,594 - DEBUG - Flushing log file after loading UI
2025-10-02 19:34:41,675 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oMQ.EIqOQdQYBLhqwqIZVT5txUDe2NE'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oMQ.EIqOQdQYBLhqwqIZVT5txUDe2NE'}
2025-10-02 19:34:41,675 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oMQ.EIqOQdQYBLhqwqIZVT5txUDe2NE'})
2025-10-02 19:34:41,675 - DEBUG - Reusing existing CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:34:41,676 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:34:41,676 - INFO - Returning CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:34:41,676 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:34:41,680 - DEBUG - Retrieved tier for testuser: beginner
2025-10-02 19:34:41,680 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:35:35,175 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oYw.apc1nH8Qbv1kzkkDCuXkIEFaZQU'})
2025-10-02 19:35:35,175 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:35:35,183 - INFO - Reset usage for testuser
2025-10-02 19:35:35,183 - INFO - Usage reset to 0 for testuser
2025-10-02 19:35:35,183 - DEBUG - Flushing log file after usage reset
2025-10-02 19:35:47,219 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8oZw.jF664CzQ_YTy48VgLconHZlSTKg'})
2025-10-02 19:35:47,219 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:35:47,226 - INFO - Set tier for testuser to beginner
2025-10-02 19:35:47,226 - INFO - Upgraded testuser to beginner tier
2025-10-02 19:35:47,226 - DEBUG - Flushing log file after tier upgrade
2025-10-02 19:36:10,383 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:36:10,383 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 19:36:10,383 - DEBUG - Calling on_header_value with data[63:117]
2025-10-02 19:36:10,383 - DEBUG - Calling on_header_end with no data
2025-10-02 19:36:10,383 - DEBUG - Calling on_header_field with data[119:131]
2025-10-02 19:36:10,383 - DEBUG - Calling on_header_value with data[133:157]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_data with data[161:652]
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_field with data[696:715]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_value with data[717:751]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_field with data[799:818]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_value with data[820:851]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_end with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_field with data[899:918]
2025-10-02 19:36:10,384 - DEBUG - Calling on_header_value with data[920:946]
2025-10-02 19:36:10,385 - DEBUG - Calling on_header_end with no data
2025-10-02 19:36:10,385 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:36:10,385 - DEBUG - Calling on_part_data with data[950:958]
2025-10-02 19:36:10,385 - DEBUG - Calling on_part_end with no data
2025-10-02 19:36:10,385 - DEBUG - Calling on_end with no data
2025-10-02 19:36:10,385 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1004', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundaryQl0YJPBl0oeqhyNB', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8ocw.-fLJF-Bcn3td8CHeUDgsD1On4wA'})
2025-10-02 19:36:10,385 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:36:10,386 - DEBUG - File read: 491 bytes for user anonymous
2025-10-02 19:36:10,387 - INFO - UsageTracker incremented to: 1, current tier: free
2025-10-02 19:36:10,387 - INFO - Audit request 1 processed for contract None with tier free for user None
2025-10-02 19:36:10,387 - DEBUG - Flushing log file after audit request
[2025-10-02 19:36:10] Raw response logging attempt
2025-10-02 19:36:10,391 - INFO - 'solc --version' running
2025-10-02 19:36:10,580 - INFO - 'solc C:\Users\client\DeFiGuard\tmpg5vwmo64.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-02 19:36:10,767 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmpg5vwmo64.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmpg5vwmo64.sol




2025-10-02 19:36:10,778 - INFO - Slither analysis completed successfully.
2025-10-02 19:36:10,779 - INFO - Fuzzing skipped for free tier
2025-10-02 19:36:10,782 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found.\nFuzzing Results: [].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount, "Insufficient balance");\r\n        (bool sent, ) = msg.sender.call{value: amount}("");\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: free.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-02 19:36:10,822 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-02 19:36:10,822 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-02 19:36:10,887 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A6B78C0>
2025-10-02 19:36:10,887 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002435A2A91D0> server_hostname='api.x.ai' timeout=5.0
2025-10-02 19:36:10,901 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A636990>
2025-10-02 19:36:10,901 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-02 19:36:10,901 - DEBUG - send_request_headers.complete
2025-10-02 19:36:10,901 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-02 19:36:10,901 - DEBUG - send_request_body.complete
2025-10-02 19:36:10,901 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-02 19:36:37,215 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 03 Oct 2025 01:36:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-c1879e5140dd13a9bbe3e098e04d1e12-aae6d8c5000252b6-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=JlDTJLo0aqcoY1cXpNv1na7S.b3zpv6TRePjb_RP1Lg-1759455397-1.0.1.1-AlJR_a7F5c9nX1KPLQ6EgzJkiDWK_DEX65dxdU6nm19FWWl0I2zWeW.xjmgDLFIGh0fLfSFaA.ccF5NIfOgBlQhUQc0ZOMmOjdIm1xVUu0I; path=/; expires=Fri, 03-Oct-25 02:06:37 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9888b5041d2b5304-SLC')])
2025-10-02 19:36:37,216 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-02 19:36:37,216 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-02 19:36:37,216 - DEBUG - receive_response_body.complete
2025-10-02 19:36:37,216 - DEBUG - response_closed.started
2025-10-02 19:36:37,216 - DEBUG - response_closed.complete
2025-10-02 19:36:37,216 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Fri, 03 Oct 2025 01:36:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-c1879e5140dd13a9bbe3e098e04d1e12-aae6d8c5000252b6-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=JlDTJLo0aqcoY1cXpNv1na7S.b3zpv6TRePjb_RP1Lg-1759455397-1.0.1.1-AlJR_a7F5c9nX1KPLQ6EgzJkiDWK_DEX65dxdU6nm19FWWl0I2zWeW.xjmgDLFIGh0fLfSFaA.ccF5NIfOgBlQhUQc0ZOMmOjdIm1xVUu0I; path=/; expires=Fri, 03-Oct-25 02:06:37 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '9888b5041d2b5304-SLC'})
2025-10-02 19:36:37,216 - DEBUG - request_id: 00-c1879e5140dd13a9bbe3e098e04d1e12-aae6d8c5000252b6-01
[2025-10-02 19:36:10] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability in the withdraw function to drain the contract's funds by repeatedly calling withdraw before the balance is updated.","impact":"High"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Consider using OpenZeppelin's ReentrancyGuard for added security.","Review the contract for compliance with MiCA regulations on crypto-asset transparency and SEC FIT21 guidelines on digital asset classifications, though no specific violations are evident in this simple contract."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:36:37,221 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability in the withdraw function to drain the contract's funds by repeatedly calling withdraw before the balance is updated.","impact":"High"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Consider using OpenZeppelin's ReentrancyGuard for added security.","Review the contract for compliance with MiCA regulations on crypto-asset transparency and SEC FIT21 guidelines on digital asset classifications, though no specific violations are evident in this simple contract."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:36:37,223 - DEBUG - Flushing log file after successful audit
2025-10-02 19:36:53,958 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/pro, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8opQ.fiaRmhfmadgfEmaSjkc0XSnUMTk'})
2025-10-02 19:36:53,958 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:36:53,966 - INFO - Set tier for testuser to pro
2025-10-02 19:36:53,966 - INFO - Upgraded testuser to pro tier
2025-10-02 19:36:53,966 - DEBUG - Flushing log file after tier upgrade
2025-10-02 19:37:08,998 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_value with data[63:117]
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_end with no data
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_field with data[119:131]
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_value with data[133:157]
2025-10-02 19:37:08,999 - DEBUG - Calling on_header_end with no data
2025-10-02 19:37:08,999 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:37:08,999 - DEBUG - Calling on_part_data with data[161:652]
2025-10-02 19:37:08,999 - DEBUG - Calling on_part_end with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_field with data[696:715]
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_value with data[717:751]
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_end with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_part_end with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_field with data[799:818]
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_value with data[820:851]
2025-10-02 19:37:09,000 - DEBUG - Calling on_header_end with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:37:09,000 - DEBUG - Calling on_part_end with no data
2025-10-02 19:37:09,001 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:37:09,001 - DEBUG - Calling on_header_field with data[899:918]
2025-10-02 19:37:09,001 - DEBUG - Calling on_header_value with data[920:946]
2025-10-02 19:37:09,001 - DEBUG - Calling on_header_end with no data
2025-10-02 19:37:09,001 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:37:09,001 - DEBUG - Calling on_part_data with data[950:958]
2025-10-02 19:37:09,001 - DEBUG - Calling on_part_end with no data
2025-10-02 19:37:09,001 - DEBUG - Calling on_end with no data
2025-10-02 19:37:09,002 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1004', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundaryrnc69ZTmqIy4ojtI', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8otQ._icN2aCeYadMXF5PjqHVh9k4dCM'})
2025-10-02 19:37:09,002 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:37:09,002 - DEBUG - File read: 491 bytes for user anonymous
2025-10-02 19:37:09,004 - INFO - UsageTracker incremented to: 1, current tier: free
2025-10-02 19:37:09,004 - INFO - Audit request 1 processed for contract None with tier free for user None
2025-10-02 19:37:09,004 - DEBUG - Flushing log file after audit request
[2025-10-02 19:37:09] Raw response logging attempt
2025-10-02 19:37:09,009 - INFO - 'solc --version' running
2025-10-02 19:37:09,193 - INFO - 'solc C:\Users\client\DeFiGuard\tmprwot2bdb.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-02 19:37:09,376 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmprwot2bdb.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmprwot2bdb.sol




2025-10-02 19:37:09,382 - INFO - Slither analysis completed successfully.
2025-10-02 19:37:09,382 - INFO - Fuzzing skipped for free tier
2025-10-02 19:37:09,385 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found.\nFuzzing Results: [].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount, "Insufficient balance");\r\n        (bool sent, ) = msg.sender.call{value: amount}("");\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: free.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-02 19:37:09,385 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-02 19:37:09,386 - DEBUG - close.started
2025-10-02 19:37:09,386 - DEBUG - close.complete
2025-10-02 19:37:09,386 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-02 19:37:09,411 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A71AFD0>
2025-10-02 19:37:09,411 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002435A2A91D0> server_hostname='api.x.ai' timeout=5.0
2025-10-02 19:37:09,424 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A6536F0>
2025-10-02 19:37:09,424 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-02 19:37:09,424 - DEBUG - send_request_headers.complete
2025-10-02 19:37:09,424 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-02 19:37:09,424 - DEBUG - send_request_body.complete
2025-10-02 19:37:09,424 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-02 19:37:36,998 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 03 Oct 2025 01:37:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-6d56ad93788a967256b14d727242a989-a5179d950001fe92-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9888b671df7fe888-SLC')])
2025-10-02 19:37:36,999 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-02 19:37:36,999 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-02 19:37:36,999 - DEBUG - receive_response_body.complete
2025-10-02 19:37:36,999 - DEBUG - response_closed.started
2025-10-02 19:37:36,999 - DEBUG - response_closed.complete
2025-10-02 19:37:36,999 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Fri, 03 Oct 2025 01:37:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-6d56ad93788a967256b14d727242a989-a5179d950001fe92-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '9888b671df7fe888-SLC'})
2025-10-02 19:37:36,999 - DEBUG - request_id: 00-6d56ad93788a967256b14d727242a989-a5179d950001fe92-01
[2025-10-02 19:37:09] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern or implement a reentrancy guard."},{"type":"Regulatory Compliance - MiCA","severity":"Med","fix":"Ensure the token complies with MiCA requirements for asset-referenced tokens if applicable, including reserve requirements and disclosure obligations."},{"type":"Regulatory Compliance - SEC FIT21","severity":"Med","fix":"Assess if the token qualifies as a digital asset under FIT21 and comply with registration or exemption rules for securities."}],"predictions":[{"scenario":"An attacker exploits the reentrancy vulnerability by repeatedly calling withdraw before the balance is updated, draining the contract's funds.","impact":"High"},{"scenario":"Non-compliance with MiCA regulations leads to legal penalties in EU jurisdictions by 2025.","impact":"Med"},{"scenario":"Failure to adhere to SEC FIT21 guidelines results in enforcement actions for unregistered securities.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a thorough audit of the contract for other potential vulnerabilities.","Review and ensure compliance with MiCA for crypto-asset services, including transparency and consumer protection measures.","Evaluate the token under SEC FIT21 to determine if it needs registration as a security or qualifies for exemptions.","Consider adding access controls or modifiers for better security."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:37:37,002 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern or implement a reentrancy guard."},{"type":"Regulatory Compliance - MiCA","severity":"Med","fix":"Ensure the token complies with MiCA requirements for asset-referenced tokens if applicable, including reserve requirements and disclosure obligations."},{"type":"Regulatory Compliance - SEC FIT21","severity":"Med","fix":"Assess if the token qualifies as a digital asset under FIT21 and comply with registration or exemption rules for securities."}],"predictions":[{"scenario":"An attacker exploits the reentrancy vulnerability by repeatedly calling withdraw before the balance is updated, draining the contract's funds.","impact":"High"},{"scenario":"Non-compliance with MiCA regulations leads to legal penalties in EU jurisdictions by 2025.","impact":"Med"},{"scenario":"Failure to adhere to SEC FIT21 guidelines results in enforcement actions for unregistered securities.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a thorough audit of the contract for other potential vulnerabilities.","Review and ensure compliance with MiCA for crypto-asset services, including transparency and consumer protection measures.","Evaluate the token under SEC FIT21 to determine if it needs registration as a security or qualifies for exemptions.","Consider adding access controls or modifiers for better security."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:37:37,004 - DEBUG - Flushing log file after successful audit
2025-10-02 19:40:07,260 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/diamond, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8pcg.BB4cLPLWBiFaQdfOPwxJfbinAGU'})
2025-10-02 19:40:07,260 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:40:07,266 - INFO - Set tier for testuser to diamond
2025-10-02 19:40:07,266 - INFO - Upgraded testuser to diamond tier
2025-10-02 19:40:07,266 - DEBUG - Flushing log file after tier upgrade
2025-10-02 19:40:22,403 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:40:22,403 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 19:40:22,403 - DEBUG - Calling on_header_value with data[63:117]
2025-10-02 19:40:22,403 - DEBUG - Calling on_header_end with no data
2025-10-02 19:40:22,403 - DEBUG - Calling on_header_field with data[119:131]
2025-10-02 19:40:22,403 - DEBUG - Calling on_header_value with data[133:157]
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_data with data[161:652]
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_field with data[696:715]
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_value with data[717:751]
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_field with data[799:818]
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_value with data[820:851]
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_end with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_part_begin with no data
2025-10-02 19:40:22,404 - DEBUG - Calling on_header_field with data[899:918]
2025-10-02 19:40:22,405 - DEBUG - Calling on_header_value with data[920:946]
2025-10-02 19:40:22,405 - DEBUG - Calling on_header_end with no data
2025-10-02 19:40:22,405 - DEBUG - Calling on_headers_finished with no data
2025-10-02 19:40:22,405 - DEBUG - Calling on_part_data with data[950:958]
2025-10-02 19:40:22,405 - DEBUG - Calling on_part_end with no data
2025-10-02 19:40:22,405 - DEBUG - Calling on_end with no data
2025-10-02 19:40:22,406 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1004', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundarygRSLaIQlHEd6C0Ui', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8pdw.6VmFsFb0vUTrBLvNbl1gAqcue70'})
2025-10-02 19:40:22,406 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:40:22,406 - DEBUG - File read: 491 bytes for user anonymous
2025-10-02 19:40:22,408 - INFO - UsageTracker incremented to: 1, current tier: free
2025-10-02 19:40:22,408 - INFO - Audit request 1 processed for contract None with tier free for user None
2025-10-02 19:40:22,408 - DEBUG - Flushing log file after audit request
[2025-10-02 19:40:22] Raw response logging attempt
2025-10-02 19:40:22,410 - INFO - 'solc --version' running
2025-10-02 19:40:22,598 - INFO - 'solc C:\Users\client\DeFiGuard\tmph2fqeeho.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-02 19:40:22,780 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmph2fqeeho.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmph2fqeeho.sol




2025-10-02 19:40:22,788 - INFO - Slither analysis completed successfully.
2025-10-02 19:40:22,789 - INFO - Fuzzing skipped for free tier
2025-10-02 19:40:22,792 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found.\nFuzzing Results: [].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount, "Insufficient balance");\r\n        (bool sent, ) = msg.sender.call{value: amount}("");\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: free.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-02 19:40:22,792 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-02 19:40:22,792 - DEBUG - close.started
2025-10-02 19:40:22,793 - DEBUG - close.complete
2025-10-02 19:40:22,793 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-02 19:40:22,827 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A5D3360>
2025-10-02 19:40:22,827 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002435A2A91D0> server_hostname='api.x.ai' timeout=5.0
2025-10-02 19:40:22,839 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002435A677D10>
2025-10-02 19:40:22,839 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-02 19:40:22,839 - DEBUG - send_request_headers.complete
2025-10-02 19:40:22,839 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-02 19:40:22,840 - DEBUG - send_request_body.complete
2025-10-02 19:40:22,840 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-02 19:40:57,280 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 03 Oct 2025 01:40:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-c80538a4ff9f452e92cedb52ee33b646-37de04c1000205d0-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9888bb2abbfd1258-SLC')])
2025-10-02 19:40:57,280 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-02 19:40:57,280 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-02 19:40:57,280 - DEBUG - receive_response_body.complete
2025-10-02 19:40:57,281 - DEBUG - response_closed.started
2025-10-02 19:40:57,281 - DEBUG - response_closed.complete
2025-10-02 19:40:57,281 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Fri, 03 Oct 2025 01:40:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-c80538a4ff9f452e92cedb52ee33b646-37de04c1000205d0-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '9888bb2abbfd1258-SLC'})
2025-10-02 19:40:57,281 - DEBUG - request_id: 00-c80538a4ff9f452e92cedb52ee33b646-37de04c1000205d0-01
[2025-10-02 19:40:22] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability by repeatedly calling the withdraw function before the balance is updated, draining the contract's funds.","impact":"High"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Consider using OpenZeppelin's ReentrancyGuard for added security.","For regulatory compliance under MiCA (2025), ensure the token issuance complies with asset-referenced token requirements if pegged to fiat; under SEC FIT21, classify the token appropriately to avoid unregistered security status."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:40:57,283 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability by repeatedly calling the withdraw function before the balance is updated, draining the contract's funds.","impact":"High"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Consider using OpenZeppelin's ReentrancyGuard for added security.","For regulatory compliance under MiCA (2025), ensure the token issuance complies with asset-referenced token requirements if pegged to fiat; under SEC FIT21, classify the token appropriately to avoid unregistered security status."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-02 19:40:57,283 - DEBUG - Flushing log file after successful audit
2025-10-02 19:41:42,734 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:41:42,734 - DEBUG - Flushing log file after loading UI
2025-10-02 19:41:42,758 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8p1g.GHpVp961eEnePmEIKAVeEGfXuWs'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8p1g.GHpVp961eEnePmEIKAVeEGfXuWs'}
2025-10-02 19:41:42,759 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8p1g.GHpVp961eEnePmEIKAVeEGfXuWs'})
2025-10-02 19:41:42,759 - DEBUG - Reusing existing CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:41:42,759 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:41:42,759 - INFO - Returning CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:41:42,759 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:41:42,762 - DEBUG - Retrieved tier for testuser: pro
2025-10-02 19:41:42,763 - DEBUG - Flushing log file after tier retrieval
2025-10-02 19:42:07,374 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/diamond, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8p6A.1VsdINBUw8GEF1I_-j4tgzINrJk'})
2025-10-02 19:42:07,374 - DEBUG - Flushing log file after CSRF verification
2025-10-02 19:42:07,380 - INFO - Set tier for testuser to diamond
2025-10-02 19:42:07,380 - INFO - Upgraded testuser to diamond tier
2025-10-02 19:42:07,381 - DEBUG - Flushing log file after tier upgrade
2025-10-02 19:52:14,097 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 19:52:14,097 - DEBUG - Flushing log file after loading UI
2025-10-02 19:52:14,116 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8sTg.JjCLlqdYaynK9nrgdBFZ2p4bZ2Y'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8sTg.JjCLlqdYaynK9nrgdBFZ2p4bZ2Y'}
2025-10-02 19:52:14,117 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIngzWGhhVXFBMGFGV1VMbzFEM29lc3ZLSDFpdDFuTi1LMm90QjJ2dVQyX2sifQ==.aN8sTg.JjCLlqdYaynK9nrgdBFZ2p4bZ2Y'})
2025-10-02 19:52:14,117 - DEBUG - Reusing existing CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:52:14,117 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 19:52:14,117 - INFO - Returning CSRF token: x3XhaUqA0aFWULo1D3oesvKH1it1nN-K2otB2vuT2_k
2025-10-02 19:52:14,117 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 19:52:14,120 - DEBUG - Retrieved tier for testuser: pro
2025-10-02 19:52:14,121 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-02 20:51:53
2025-10-02 20:51:53,457 - INFO - Tier switched to: free
2025-10-02 20:51:53,809 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-02 20:51:53,809 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x00000159044AF770>
2025-10-02 20:51:53,810 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-02 20:51:54,419 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-02 20:51:54,419 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-02 20:51:54,471 - DEBUG - Using proactor: IocpProactor
2025-10-02 20:52:47,622 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 20:52:47,623 - DEBUG - Flushing log file after loading auth
2025-10-02 20:52:47,773 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-02 20:52:47,773 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-02 20:52:47,773 - INFO - Generated new CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:52:47,773 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 20:52:47,773 - INFO - Returning CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:52:47,773 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 20:52:51,709 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-02 20:52:51,709 - DEBUG - Flushing log file after loading UI
2025-10-02 20:52:51,816 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86gw.qLczH0bJoBxIX9RX6z3_8E5ahPg'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86gw.qLczH0bJoBxIX9RX6z3_8E5ahPg'}
2025-10-02 20:52:51,816 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86gw.qLczH0bJoBxIX9RX6z3_8E5ahPg'})
2025-10-02 20:52:51,816 - DEBUG - Reusing existing CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:52:51,816 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 20:52:51,816 - INFO - Returning CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:52:51,816 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 20:52:51,825 - DEBUG - Retrieved tier for testuser: pro
2025-10-02 20:52:51,825 - DEBUG - Flushing log file after tier retrieval
2025-10-02 20:54:09,547 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86zg.BizXxmN0UB5t9CXwz6Q864aj8II'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86zg.BizXxmN0UB5t9CXwz6Q864aj8II'}
2025-10-02 20:54:09,547 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN86zg.BizXxmN0UB5t9CXwz6Q864aj8II'})
2025-10-02 20:54:09,547 - DEBUG - Reusing existing CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:54:09,547 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 20:54:09,547 - INFO - Returning CSRF token: gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY
2025-10-02 20:54:09,547 - DEBUG - Flushing log file after returning CSRF token
2025-10-02 20:54:09,553 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/reset-usage?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN860Q.0luNBU-7n7bs2ZyAPiVxhaQ9lJA'})
2025-10-02 20:54:09,553 - DEBUG - Flushing log file after CSRF verification
2025-10-02 20:54:09,561 - INFO - Reset usage for testuser
2025-10-02 20:54:09,561 - INFO - Usage reset to 0 for testuser
2025-10-02 20:54:09,561 - DEBUG - Flushing log file after usage reset
2025-10-02 20:54:20,409 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/testuser/pro, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN860Q.0luNBU-7n7bs2ZyAPiVxhaQ9lJA'})
2025-10-02 20:54:20,409 - DEBUG - Flushing log file after CSRF verification
2025-10-02 20:54:20,416 - INFO - Set tier for testuser to pro
2025-10-02 20:54:20,416 - INFO - Upgraded testuser to pro tier
2025-10-02 20:54:20,416 - DEBUG - Flushing log file after tier upgrade
2025-10-02 20:55:22,739 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_value with data[63:117]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_end with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_field with data[119:131]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_value with data[133:157]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_end with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_part_data with data[161:652]
2025-10-02 20:55:22,740 - DEBUG - Calling on_part_end with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_field with data[696:715]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_value with data[717:751]
2025-10-02 20:55:22,740 - DEBUG - Calling on_header_end with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:55:22,740 - DEBUG - Calling on_part_end with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_field with data[799:818]
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_value with data[820:851]
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_end with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_part_end with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_field with data[899:918]
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_value with data[920:946]
2025-10-02 20:55:22,741 - DEBUG - Calling on_header_end with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_part_data with data[950:958]
2025-10-02 20:55:22,741 - DEBUG - Calling on_part_end with no data
2025-10-02 20:55:22,741 - DEBUG - Calling on_end with no data
2025-10-02 20:55:22,742 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1004', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundaryfH6ZbN4NJojopOLC', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN863A.mNssa5E4eK8MGi_LBvTyHpE_3rc'})
2025-10-02 20:55:22,742 - DEBUG - Flushing log file after CSRF verification
2025-10-02 20:55:22,743 - DEBUG - File read: 491 bytes for user testuser
2025-10-02 20:55:22,752 - INFO - UsageTracker incremented to: 1 for testuser, current tier: pro
2025-10-02 20:55:22,752 - INFO - Audit request 1 processed for contract None with tier pro for user testuser
2025-10-02 20:55:22,752 - DEBUG - Flushing log file after audit request
[2025-10-02 20:55:22] Raw response logging attempt
2025-10-02 20:55:22,756 - INFO - 'solc --version' running
2025-10-02 20:55:22,938 - INFO - 'solc C:\Users\client\DeFiGuard\tmpl8up_ngv.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-02 20:55:23,115 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmpl8up_ngv.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmpl8up_ngv.sol




2025-10-02 20:55:23,127 - INFO - Slither analysis completed successfully.
2025-10-02 20:55:24,743 - INFO - Echidna fuzzing completed successfully
2025-10-02 20:55:24,743 - DEBUG - Echidna results: 
2025-10-02 20:55:24,749 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found\nEchidna fuzzing results: [{"vulnerability": "Potential issue", "description": "No vulnerabilities found by Echidna"}].\nFuzzing Results: [{"vulnerability": "Potential issue", "description": "No vulnerabilities found by Echidna"}].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount, "Insufficient balance");\r\n        (bool sent, ) = msg.sender.call{value: amount}("");\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: pro.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-02 20:55:24,791 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-02 20:55:24,791 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-02 20:55:24,851 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015904840440>
2025-10-02 20:55:24,851 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000159043F9310> server_hostname='api.x.ai' timeout=5.0
2025-10-02 20:55:24,887 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015904782D50>
2025-10-02 20:55:24,887 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-02 20:55:24,887 - DEBUG - send_request_headers.complete
2025-10-02 20:55:24,887 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-02 20:55:24,887 - DEBUG - send_request_body.complete
2025-10-02 20:55:24,887 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-02 20:56:20,075 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 03 Oct 2025 02:56:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-db1a61a1befff645f7b63f7d5311a8c3-3a5b90fb00050d43-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=gJTR67Hro1f4Mtnqc3Yy8HQIhVmUgVprJG.PVoZeW0U-1759460180-1.0.1.1-rtDlTN4SYesfigkIhwCbiuQBe_uS0m5HdBpBuS8Sod4wKkhYDnuvXRJehChR_zFttsg8C_MOv3biHs4ONHx6nCDmWz7jrr9Ob.062yAcwD0; path=/; expires=Fri, 03-Oct-25 03:26:20 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9889291488455179-DEN')])
2025-10-02 20:56:20,076 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-02 20:56:20,076 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-02 20:56:20,076 - DEBUG - receive_response_body.complete
2025-10-02 20:56:20,076 - DEBUG - response_closed.started
2025-10-02 20:56:20,076 - DEBUG - response_closed.complete
2025-10-02 20:56:20,076 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Fri, 03 Oct 2025 02:56:20 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-db1a61a1befff645f7b63f7d5311a8c3-3a5b90fb00050d43-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=gJTR67Hro1f4Mtnqc3Yy8HQIhVmUgVprJG.PVoZeW0U-1759460180-1.0.1.1-rtDlTN4SYesfigkIhwCbiuQBe_uS0m5HdBpBuS8Sod4wKkhYDnuvXRJehChR_zFttsg8C_MOv3biHs4ONHx6nCDmWz7jrr9Ob.062yAcwD0; path=/; expires=Fri, 03-Oct-25 03:26:20 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '9889291488455179-DEN'})
2025-10-02 20:56:20,076 - DEBUG - request_id: 00-db1a61a1befff645f7b63f7d5311a8c3-3a5b90fb00050d43-01
[2025-10-02 20:55:22] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern. Move 'balances[msg.sender] -= amount;' before the call."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability by recursively calling the withdraw function before the balance is updated, potentially draining all funds from the contract.","impact":"High"},{"scenario":"Under MiCA 2025 regulations, failure to secure smart contracts could lead to non-compliance with stability and security requirements for asset-referenced tokens, resulting in regulatory penalties.","impact":"Med"},{"scenario":"SEC FIT21 2025 might classify this as a digital asset with insufficient safeguards, leading to enforcement actions for inadequate investor protection.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a full security audit to ensure compliance with MiCA's requirements for crypto-asset service providers, including robust risk management and cybersecurity measures.","Align with SEC FIT21 by incorporating decentralized finance safeguards, such as regular vulnerability assessments and transparent reporting of security incidents.","Consider using OpenZeppelin's ReentrancyGuard for added protection.","For advanced regulatory insights: Under MiCA, ensure the token meets criteria for electronic money tokens if applicable, with mandatory whitepaper and liability provisions. For FIT21, prepare for potential registration as a digital asset entity with emphasis on anti-fraud measures."],"remediation_roadmap":null,"fuzzing_results":[{"vulnerability":"Potential issue","description":"No vulnerabilities found by Echidna"}]}
2025-10-02 20:56:20,083 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern. Move 'balances[msg.sender] -= amount;' before the call."}],"predictions":[{"scenario":"An attacker could exploit the reentrancy vulnerability by recursively calling the withdraw function before the balance is updated, potentially draining all funds from the contract.","impact":"High"},{"scenario":"Under MiCA 2025 regulations, failure to secure smart contracts could lead to non-compliance with stability and security requirements for asset-referenced tokens, resulting in regulatory penalties.","impact":"Med"},{"scenario":"SEC FIT21 2025 might classify this as a digital asset with insufficient safeguards, leading to enforcement actions for inadequate investor protection.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy attacks.","Conduct a full security audit to ensure compliance with MiCA's requirements for crypto-asset service providers, including robust risk management and cybersecurity measures.","Align with SEC FIT21 by incorporating decentralized finance safeguards, such as regular vulnerability assessments and transparent reporting of security incidents.","Consider using OpenZeppelin's ReentrancyGuard for added protection.","For advanced regulatory insights: Under MiCA, ensure the token meets criteria for electronic money tokens if applicable, with mandatory whitepaper and liability provisions. For FIT21, prepare for potential registration as a digital asset entity with emphasis on anti-fraud measures."],"remediation_roadmap":null,"fuzzing_results":[{"vulnerability":"Potential issue","description":"No vulnerabilities found by Echidna"}]}
2025-10-02 20:56:20,089 - DEBUG - Flushing log file after successful audit
2025-10-02 20:56:57,126 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_field with data[42:61]
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_value with data[63:122]
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_end with no data
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_field with data[124:136]
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_value with data[138:162]
2025-10-02 20:56:57,126 - DEBUG - Calling on_header_end with no data
2025-10-02 20:56:57,126 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:56:57,127 - DEBUG - Calling on_part_data with data[166:49151]
2025-10-02 20:56:57,127 - DEBUG - Calling on_part_data with data[0:1]
2025-10-02 20:56:57,127 - DEBUG - Calling on_part_data with data[0:81920]
2025-10-02 20:56:57,128 - DEBUG - Calling on_part_data with data[0:131072]
2025-10-02 20:56:57,128 - DEBUG - Calling on_part_data with data[0:49152]
2025-10-02 20:56:57,129 - DEBUG - Calling on_part_data with data[0:32766]
2025-10-02 20:56:57,129 - DEBUG - Calling on_part_data with data[0:2]
2025-10-02 20:56:57,129 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,129 - DEBUG - Calling on_part_data with data[0:16384]
2025-10-02 20:56:57,129 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:32766]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:2]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:49152]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:65536]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,130 - DEBUG - Calling on_part_data with data[0:49152]
2025-10-02 20:56:57,131 - DEBUG - Calling on_part_data with data[0:49152]
2025-10-02 20:56:57,131 - DEBUG - Calling on_part_data with data[0:65536]
2025-10-02 20:56:57,131 - DEBUG - Calling on_part_data with data[0:81920]
2025-10-02 20:56:57,132 - DEBUG - Calling on_part_data with data[0:65536]
2025-10-02 20:56:57,132 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,132 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,133 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,133 - DEBUG - Calling on_part_data with data[0:32768]
2025-10-02 20:56:57,134 - DEBUG - Calling on_part_data with data[0:81920]
2025-10-02 20:56:57,136 - DEBUG - Calling on_part_data with data[0:97170]
2025-10-02 20:56:57,136 - DEBUG - Calling on_part_end with no data
2025-10-02 20:56:57,136 - DEBUG - Calling on_part_begin with no data
2025-10-02 20:56:57,136 - DEBUG - Calling on_header_field with data[97214:97233]
2025-10-02 20:56:57,136 - DEBUG - Calling on_header_value with data[97235:97261]
2025-10-02 20:56:57,136 - DEBUG - Calling on_header_end with no data
2025-10-02 20:56:57,137 - DEBUG - Calling on_headers_finished with no data
2025-10-02 20:56:57,137 - DEBUG - Calling on_part_data with data[97265:97273]
2025-10-02 20:56:57,137 - DEBUG - Calling on_part_end with no data
2025-10-02 20:56:57,137 - DEBUG - Calling on_end with no data
2025-10-02 20:56:57,138 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/diamond-audit?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1227815', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundary4crPhAA39PJ96NKB', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN87VA.NYMcyh3qlra0V0ZJ-wCYUfiCAu8'})
2025-10-02 20:56:57,138 - DEBUG - Flushing log file after CSRF verification
2025-10-02 20:56:57,140 - INFO - Diamond audit purchased for testuser at $25000 for file size 1.17MB (mock Stripe payment)
2025-10-02 20:56:57,140 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/diamond-audit?username=testuser, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '1227815', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'gXUkBzo631jm7G8dGphoP-rVwmigctc3K5TIZeeUPiY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundary4crPhAA39PJ96NKB', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogImdYVWtCem82MzFqbTdHOGRHcGhvUC1yVndtaWdjdGMzSzVUSVplZVVQaVkifQ==.aN87VA.NYMcyh3qlra0V0ZJ-wCYUfiCAu8'})
2025-10-02 20:56:57,140 - DEBUG - Flushing log file after CSRF verification
2025-10-02 20:56:57,141 - DEBUG - File read: 1227500 bytes for user testuser
2025-10-02 22:16:16,717 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-02 22:16:16,719 - DEBUG - Flushing log file after loading auth
2025-10-02 22:16:16,801 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-02 22:16:16,801 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-02 22:16:16,801 - INFO - Generated new CSRF token: Hwj8AvW3RW6Go2WvfLS2y0i_e5nPGxr30Nr_vREj9AQ
2025-10-02 22:16:16,801 - DEBUG - Flushing log file after CSRF token generation
2025-10-02 22:16:16,801 - INFO - Returning CSRF token: Hwj8AvW3RW6Go2WvfLS2y0i_e5nPGxr30Nr_vREj9AQ
2025-10-02 22:16:16,802 - DEBUG - Flushing log file after returning CSRF token
Logging initialized at 2025-10-03 11:37:30
2025-10-03 11:37:30,739 - INFO - Tier switched to: free
2025-10-03 11:37:31,279 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-03 11:37:31,280 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x0000018813F5E900>
2025-10-03 11:37:31,281 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-03 11:37:32,165 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-03 11:37:32,166 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
Logging initialized at 2025-10-03 11:38:03
2025-10-03 11:38:03,195 - INFO - Tier switched to: free
2025-10-03 11:38:03,660 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-03 11:38:03,660 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x00000250AB6742F0>
2025-10-03 11:38:03,661 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-03 11:38:04,372 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-03 11:38:04,373 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-03 11:38:04,452 - DEBUG - Using proactor: IocpProactor
2025-10-03 11:38:25,705 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-03 11:38:25,705 - DEBUG - Flushing log file after loading UI
2025-10-03 11:38:25,866 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-03 11:38:25,867 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-03 11:38:25,867 - INFO - Generated new CSRF token: FjiKHAjC7rseSRAEH_ED0SESNpVcTt3GLqAhBQ1iP5c
2025-10-03 11:38:25,867 - DEBUG - Flushing log file after CSRF token generation
2025-10-03 11:38:25,867 - INFO - Returning CSRF token: FjiKHAjC7rseSRAEH_ED0SESNpVcTt3GLqAhBQ1iP5c
2025-10-03 11:38:25,867 - DEBUG - Flushing log file after returning CSRF token
2025-10-03 11:38:25,878 - DEBUG - Retrieved tier for user2: free
2025-10-03 11:38:25,878 - DEBUG - Flushing log file after tier retrieval
2025-10-03 11:39:19,944 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/user2/beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'FjiKHAjC7rseSRAEH_ED0SESNpVcTt3GLqAhBQ1iP5c', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkZqaUtIQWpDN3JzZVNSQUVIX0VEMFNFU05wVmNUdDNHTHFBaEJRMWlQNWMifQ==.aOAKEQ.olakEyLUyPdO8AnWohH4E4r1ob0'})
2025-10-03 11:39:19,944 - DEBUG - Flushing log file after CSRF verification
2025-10-03 11:39:19,954 - INFO - Set tier for user2 to beginner
2025-10-03 11:39:19,954 - INFO - Upgraded user2 to beginner tier
2025-10-03 11:39:19,954 - DEBUG - Flushing log file after tier upgrade
2025-10-03 11:39:24,816 - DEBUG - Retrieved tier for user2: beginner
2025-10-03 11:39:24,816 - DEBUG - Flushing log file after tier retrieval
2025-10-03 11:39:27,584 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/user2/pro, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'FjiKHAjC7rseSRAEH_ED0SESNpVcTt3GLqAhBQ1iP5c', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkZqaUtIQWpDN3JzZVNSQUVIX0VEMFNFU05wVmNUdDNHTHFBaEJRMWlQNWMifQ==.aOAKTA.frlHKMCaJRnOcfKBR8b3moQDm6I'})
2025-10-03 11:39:27,584 - DEBUG - Flushing log file after CSRF verification
2025-10-03 11:39:27,591 - INFO - Set tier for user2 to pro
2025-10-03 11:39:27,591 - INFO - Upgraded user2 to pro tier
2025-10-03 11:39:27,591 - DEBUG - Flushing log file after tier upgrade
2025-10-03 11:39:29,848 - DEBUG - Retrieved tier for user2: pro
2025-10-03 11:39:29,848 - DEBUG - Flushing log file after tier retrieval
2025-10-03 11:39:39,635 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/user2/diamond, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'FjiKHAjC7rseSRAEH_ED0SESNpVcTt3GLqAhBQ1iP5c', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkZqaUtIQWpDN3JzZVNSQUVIX0VEMFNFU05wVmNUdDNHTHFBaEJRMWlQNWMifQ==.aOAKUQ.aqJgNTuZ2bYaeC2TEezMTlQxZt8'})
2025-10-03 11:39:39,636 - DEBUG - Flushing log file after CSRF verification
2025-10-03 11:39:39,642 - INFO - Set tier for user2 to diamond
2025-10-03 11:39:39,642 - INFO - Upgraded user2 to diamond tier
2025-10-03 11:39:39,642 - DEBUG - Flushing log file after tier upgrade
2025-10-03 11:39:41,972 - DEBUG - Retrieved tier for user2: pro
2025-10-03 11:39:41,972 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-03 12:51:42
2025-10-03 12:51:42,837 - INFO - Tier switched to: free
2025-10-03 12:51:43,283 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-03 12:51:43,284 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x00000146D4D341A0>
2025-10-03 12:51:43,285 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-03 12:51:43,986 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-03 12:51:43,986 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-03 12:51:44,040 - DEBUG - Using proactor: IocpProactor
2025-10-03 12:51:48,620 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-03 12:51:48,620 - DEBUG - Flushing log file after loading UI
2025-10-03 12:51:48,704 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-03 12:51:48,704 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-03 12:51:48,704 - INFO - Generated new CSRF token: R2w-72kIYLvkBDtwNZ68TR7QO5WQMtJRt18titiSdRc
2025-10-03 12:51:48,704 - DEBUG - Flushing log file after CSRF token generation
2025-10-03 12:51:48,704 - INFO - Returning CSRF token: R2w-72kIYLvkBDtwNZ68TR7QO5WQMtJRt18titiSdRc
2025-10-03 12:51:48,704 - DEBUG - Flushing log file after returning CSRF token
2025-10-03 12:51:48,729 - DEBUG - Retrieved tier for user2: pro
2025-10-03 12:51:48,730 - DEBUG - Flushing log file after tier retrieval
2025-10-03 12:52:04,369 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/user2/beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'R2w-72kIYLvkBDtwNZ68TR7QO5WQMtJRt18titiSdRc', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlIydy03MmtJWUx2a0JEdHdOWjY4VFI3UU81V1FNdEpSdDE4dGl0aVNkUmMifQ==.aOAbRA.RMNcQRzynfiiidazX6e436rGJ78'})
2025-10-03 12:52:04,370 - DEBUG - Flushing log file after CSRF verification
2025-10-03 12:52:04,378 - INFO - Set tier for user2 to beginner
2025-10-03 12:52:04,379 - INFO - Upgraded user2 to beginner tier
2025-10-03 12:52:04,379 - DEBUG - Flushing log file after tier upgrade
2025-10-03 12:52:07,176 - DEBUG - Retrieved tier for user2: beginner
2025-10-03 12:52:07,176 - DEBUG - Flushing log file after tier retrieval
2025-10-03 12:52:33,737 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/set-tier/user2/diamond, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'R2w-72kIYLvkBDtwNZ68TR7QO5WQMtJRt18titiSdRc', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlIydy03MmtJWUx2a0JEdHdOWjY4VFI3UU81V1FNdEpSdDE4dGl0aVNkUmMifQ==.aOAbVw.cK3kOW-R0h3PbJgBpFw3V0jmX0E'})
2025-10-03 12:52:33,737 - DEBUG - Flushing log file after CSRF verification
2025-10-03 12:52:33,742 - INFO - Set tier for user2 to diamond
2025-10-03 12:52:33,743 - INFO - Upgraded user2 to diamond tier
2025-10-03 12:52:33,743 - DEBUG - Flushing log file after tier upgrade
2025-10-03 12:52:36,342 - DEBUG - Retrieved tier for user2: pro
2025-10-03 12:52:36,342 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-06 19:18:02
2025-10-06 19:18:02,934 - INFO - Tier switched to: free
2025-10-06 19:18:03,424 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-06 19:18:03,425 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001DDD4CF02F0>
2025-10-06 19:18:03,426 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-06 19:18:04,200 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-06 19:18:04,201 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-06 19:18:04,304 - DEBUG - Using proactor: IocpProactor
2025-10-06 19:25:37,469 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-06 19:25:37,469 - DEBUG - Flushing log file after loading UI
2025-10-06 19:25:37,598 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-06 19:25:37,598 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-purpose': 'prefetch;prerender', 'sec-ch-ua-mobile': '?0', 'purpose': 'prefetch', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-06 19:25:37,598 - INFO - Generated new CSRF token: EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE
2025-10-06 19:25:37,598 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 19:25:37,598 - INFO - Returning CSRF token: EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE
2025-10-06 19:25:37,598 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 19:25:37,607 - DEBUG - Retrieved tier for user2: pro, audit count: 1
2025-10-06 19:25:37,607 - DEBUG - Flushing log file after tier retrieval
2025-10-06 19:26:13,235 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_field with data[42:61]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_value with data[63:106]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_end with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_field with data[108:120]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_value with data[122:146]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_end with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_part_data with data[150:649]
2025-10-06 19:26:13,236 - DEBUG - Calling on_part_end with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_field with data[693:712]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_value with data[714:748]
2025-10-06 19:26:13,236 - DEBUG - Calling on_header_end with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:26:13,236 - DEBUG - Calling on_part_end with no data
2025-10-06 19:26:13,237 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:26:13,237 - DEBUG - Calling on_header_field with data[796:815]
2025-10-06 19:26:13,237 - DEBUG - Calling on_header_value with data[817:848]
2025-10-06 19:26:13,237 - DEBUG - Calling on_header_end with no data
2025-10-06 19:26:13,237 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:26:13,237 - DEBUG - Calling on_part_end with no data
2025-10-06 19:26:13,237 - DEBUG - Calling on_end with no data
2025-10-06 19:26:13,239 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit?username=user2, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '898', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundaryiCATWzd0piXzxufJ', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkVVRkJvc0FhSmZFSDZhNUMxTElNb2xxcVdOMWdPOHhYVUwtbGRhTmlZaUUifQ==.aORsEQ.a1cX-y8rJByJ9XjqpKhwDanO9Gc'})
2025-10-06 19:26:13,239 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:26:13,240 - DEBUG - File read: 499 bytes for user user2
2025-10-06 19:26:13,252 - INFO - UsageTracker incremented to: 2 for user2, current tier: pro
2025-10-06 19:26:13,253 - INFO - Audit request 2 processed for contract None with tier pro for user user2
2025-10-06 19:26:13,253 - DEBUG - Flushing log file after audit request
[2025-10-06 19:26:13] Raw response logging attempt
2025-10-06 19:26:13,256 - INFO - 'solc --version' running
2025-10-06 19:26:13,673 - INFO - 'solc C:\Users\client\DeFiGuard\tmptwgvmxbd.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-06 19:26:13,941 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmptwgvmxbd.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmptwgvmxbd.sol




2025-10-06 19:26:13,956 - INFO - Slither analysis completed successfully.
2025-10-06 19:26:14,437 - ERROR - Echidna fuzzing failed: Command '['docker', 'pull', 'trailofbits/echidna']' returned non-zero exit status 1.
2025-10-06 19:26:14,438 - ERROR - Audit error: cannot access local variable 'config_path' where it is not associated with a value
2025-10-06 19:26:14,439 - DEBUG - Flushing log file after audit error
2025-10-06 19:41:33,802 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-06 19:41:33,802 - DEBUG - Flushing log file after loading UI
2025-10-06 19:41:33,829 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkVVRkJvc0FhSmZFSDZhNUMxTElNb2xxcVdOMWdPOHhYVUwtbGRhTmlZaUUifQ==.aORvzQ.kOVOYbCvU_pD_bEec1vmOvsVxy4'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIkVVRkJvc0FhSmZFSDZhNUMxTElNb2xxcVdOMWdPOHhYVUwtbGRhTmlZaUUifQ==.aORvzQ.kOVOYbCvU_pD_bEec1vmOvsVxy4'}
2025-10-06 19:41:33,829 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkVVRkJvc0FhSmZFSDZhNUMxTElNb2xxcVdOMWdPOHhYVUwtbGRhTmlZaUUifQ==.aORvzQ.kOVOYbCvU_pD_bEec1vmOvsVxy4'})
2025-10-06 19:41:33,829 - DEBUG - Reusing existing CSRF token: EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE
2025-10-06 19:41:33,829 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 19:41:33,829 - INFO - Returning CSRF token: EUFBosAaJfEH6a5C1LIMolqqWN1gO8xXUL-ldaNiYiE
2025-10-06 19:41:33,829 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 19:41:33,834 - DEBUG - Retrieved tier for user2: pro, audit count: 2
2025-10-06 19:41:33,834 - DEBUG - Flushing log file after tier retrieval
2025-10-06 19:41:59,784 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-06 19:41:59,784 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-06 19:41:59,784 - INFO - Generated new CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:41:59,784 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 19:41:59,784 - INFO - Returning CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:41:59,784 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 19:41:59,791 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_field with data[42:61]
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_value with data[63:106]
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_field with data[108:120]
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_value with data[122:146]
2025-10-06 19:41:59,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:41:59,791 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_data with data[150:649]
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_end with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_field with data[693:712]
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_value with data[714:748]
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_end with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_end with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_field with data[796:815]
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_value with data[817:848]
2025-10-06 19:41:59,792 - DEBUG - Calling on_header_end with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_part_end with no data
2025-10-06 19:41:59,792 - DEBUG - Calling on_end with no data
2025-10-06 19:41:59,793 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit?username=, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '898', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundary4D5SLC6lTYMsxwB2', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORv5w.XO433lxljxoqs7oIZki17M37LY0'})
2025-10-06 19:41:59,794 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:42:12,499 - INFO - Loading auth from: C:\Users\client\DeFiGuard\templates\auth.html
2025-10-06 19:42:12,499 - DEBUG - Flushing log file after loading auth
2025-10-06 19:42:18,741 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORv9A.a0Jr87qsXxB-sQ2jTmYsdouGjO0'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORv9A.a0Jr87qsXxB-sQ2jTmYsdouGjO0'}
2025-10-06 19:42:18,741 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORv9A.a0Jr87qsXxB-sQ2jTmYsdouGjO0'})
2025-10-06 19:42:18,741 - DEBUG - Reusing existing CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:42:18,741 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 19:42:18,741 - INFO - Returning CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:42:18,741 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 19:43:32,506 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signin/joshonthewebb, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '24', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORv-g.GCM2uNZ8eVJFSmAtRoMi8ug4Rwg'})
2025-10-06 19:43:32,506 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:43:44,129 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/signin/user1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '26', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/auth', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwRA.rtjL-8EBuyn9rtyxBFMew6cCgdE'})
2025-10-06 19:43:44,129 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:43:44,358 - INFO - User user1 signed in
2025-10-06 19:43:44,358 - DEBUG - Flushing log file after signin
2025-10-06 19:43:44,365 - DEBUG - Retrieved tier for user1: free, audit count: 2
2025-10-06 19:43:44,365 - DEBUG - Flushing log file after tier retrieval
2025-10-06 19:43:45,387 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-06 19:43:45,387 - DEBUG - Flushing log file after loading UI
2025-10-06 19:43:45,422 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwUQ.uSC1P8rheuNfe1Z6reezmGqr4FE'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwUQ.uSC1P8rheuNfe1Z6reezmGqr4FE'}
2025-10-06 19:43:45,422 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwUQ.uSC1P8rheuNfe1Z6reezmGqr4FE'})
2025-10-06 19:43:45,422 - DEBUG - Reusing existing CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:43:45,422 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 19:43:45,422 - INFO - Returning CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 19:43:45,422 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 19:43:45,424 - DEBUG - Retrieved tier for user1: free, audit count: 2
2025-10-06 19:43:45,424 - DEBUG - Flushing log file after tier retrieval
2025-10-06 19:44:02,790 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:44:02,790 - DEBUG - Calling on_header_field with data[42:61]
2025-10-06 19:44:02,790 - DEBUG - Calling on_header_value with data[63:106]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_field with data[108:120]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_value with data[122:146]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_data with data[150:649]
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_field with data[693:712]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_value with data[714:748]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_begin with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_field with data[796:815]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_value with data[817:848]
2025-10-06 19:44:02,791 - DEBUG - Calling on_header_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_headers_finished with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_part_end with no data
2025-10-06 19:44:02,791 - DEBUG - Calling on_end with no data
2025-10-06 19:44:02,792 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/audit?username=user1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '898', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'content-type': 'multipart/form-data; boundary=----WebKitFormBoundary40eRacr846wuUznC', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwUQ.uSC1P8rheuNfe1Z6reezmGqr4FE'})
2025-10-06 19:44:02,792 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:44:02,793 - DEBUG - File read: 499 bytes for user user1
2025-10-06 19:44:02,801 - INFO - UsageTracker incremented to: 3 for user1, current tier: free
2025-10-06 19:44:02,801 - INFO - Audit request 3 processed for contract None with tier free for user user1
2025-10-06 19:44:02,801 - DEBUG - Flushing log file after audit request
[2025-10-06 19:44:02] Raw response logging attempt
2025-10-06 19:44:02,804 - INFO - 'solc --version' running
2025-10-06 19:44:03,054 - INFO - 'solc C:\Users\client\DeFiGuard\tmp_q_qgg_m.sol --combined-json abi,ast,bin,bin-runtime,srcmap,srcmap-runtime,userdoc,devdoc,hashes --allow-paths .,C:\Users\client\DeFiGuard' running
2025-10-06 19:44:03,288 - INFO - Compilation warnings/errors on C:\Users\client\DeFiGuard\tmp_q_qgg_m.sol:
Warning: SPDX license identifier not provided in source file. Before publishing, consider adding a comment containing "SPDX-License-Identifier: <SPDX-License>" to each source file. Use "SPDX-License-Identifier: UNLICENSED" for non-open-source code. Please see https://spdx.org for more information.

--> tmp_q_qgg_m.sol




2025-10-06 19:44:03,295 - INFO - Slither analysis completed successfully.
2025-10-06 19:44:03,296 - INFO - Fuzzing skipped for free tier
2025-10-06 19:44:03,300 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': '\nAnalyze this Solidity code for vulnerabilities and 2025 regulations (MiCA, SEC FIT21).\nContext: No static issues found.\nFuzzing Results: [].\nCode: pragma solidity ^0.8.0;\r\n\r\ncontract VulnerableToken {\r\n    mapping(address => uint) public balances;\r\n\r\n    function deposit() public payable {\r\n        balances[msg.sender] += msg.value;\r\n    }\r\n\r\n    function withdraw(uint amount) public {\r\n        require(balances[msg.sender] >= amount);\r\n        (bool sent, ) = msg.sender.call{value: amount}("");  // Added "" for empty calldata\r\n        if (sent) {\r\n            balances[msg.sender] -= amount; // Vulnerable to reentrancy\r\n        }\r\n    }\r\n}.\nProtocol Details: Uploaded Solidity code for analysis..\nTier: free.\nReturn the analysis in the exact JSON schema provided. For Beginner/Pro, include detailed predictions and recommendations. For Pro, add advanced regulatory insights and fuzzing results. For Diamond, include formal verification, exploit simulation, threat modeling, fuzzing results, and a remediation roadmap.\n'}], 'model': 'grok-4', 'response_format': {'type': 'json_schema', 'json_schema': {'schema': {'type': 'object', 'properties': {'risk_score': {'type': 'integer', 'minimum': 0, 'maximum': 100}, 'issues': {'type': 'array', 'items': {'type': 'object', 'properties': {'type': {'type': 'string'}, 'severity': {'type': 'string', 'enum': ['Low', 'Med', 'High']}, 'fix': {'type': 'string'}}, 'required': ['type', 'severity', 'fix']}}, 'predictions': {'type': 'array', 'items': {'type': 'object', 'properties': {'scenario': {'type': 'string'}, 'impact': {'type': 'string', 'enum': ['Low', 'Med', 'High']}}, 'required': ['scenario', 'impact']}}, 'recommendations': {'type': 'array', 'items': {'type': 'string'}}, 'remediation_roadmap': {'type': ['string', 'null']}, 'fuzzing_results': {'type': 'array', 'items': {'type': 'object', 'properties': {'vulnerability': {'type': 'string'}, 'description': {'type': 'string'}}, 'required': ['vulnerability', 'description']}}}, 'required': ['risk_score', 'issues', 'predictions', 'recommendations', 'fuzzing_results']}}, 'strict': True}, 'temperature': 0.0}}
2025-10-06 19:44:03,361 - DEBUG - Sending HTTP Request: POST https://api.x.ai/v1/chat/completions
2025-10-06 19:44:03,361 - DEBUG - connect_tcp.started host='api.x.ai' port=443 local_address=None timeout=5.0 socket_options=None
2025-10-06 19:44:13,974 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DDD9DF0AD0>
2025-10-06 19:44:13,974 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001DDD4CD3D90> server_hostname='api.x.ai' timeout=5.0
2025-10-06 19:44:16,597 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DDD996C410>
2025-10-06 19:44:16,597 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-10-06 19:44:16,598 - DEBUG - send_request_headers.complete
2025-10-06 19:44:16,598 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-10-06 19:44:16,598 - DEBUG - send_request_body.complete
2025-10-06 19:44:16,598 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-10-06 19:44:42,349 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 07 Oct 2025 01:44:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'x-zero-data-retention', b'false'), (b'x-request-id', b'00-696203495e313ffdc9b968c45e944908-c0210bbe000648ea-01'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'*'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=dYNVxTsLWGsmi4VzxP4MHqw.4cez2yY_MrAumJKtfWk-1759801482-1.0.1.1-ncvfYEFH25uX8AVZbE6nGh.pg4hQgbBIDCsQKnQpLmFoL36H3n9uN33MMuGGNWFp3M9VnegufLfM1thuFzeWIiC.IbuS.sn0imV28n4SPAA; path=/; expires=Tue, 07-Oct-25 02:14:42 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98a9b6682b6538e9-SLC')])
2025-10-06 19:44:42,349 - INFO - HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 19:44:42,350 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-10-06 19:44:42,351 - DEBUG - receive_response_body.complete
2025-10-06 19:44:42,351 - DEBUG - response_closed.started
2025-10-06 19:44:42,351 - DEBUG - response_closed.complete
2025-10-06 19:44:42,351 - DEBUG - HTTP Response: POST https://api.x.ai/v1/chat/completions "200 OK" Headers({'date': 'Tue, 07 Oct 2025 01:44:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'x-zero-data-retention': 'false', 'x-request-id': '00-696203495e313ffdc9b968c45e944908-c0210bbe000648ea-01', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-origin': '*', 'access-control-expose-headers': '*', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=dYNVxTsLWGsmi4VzxP4MHqw.4cez2yY_MrAumJKtfWk-1759801482-1.0.1.1-ncvfYEFH25uX8AVZbE6nGh.pg4hQgbBIDCsQKnQpLmFoL36H3n9uN33MMuGGNWFp3M9VnegufLfM1thuFzeWIiC.IbuS.sn0imV28n4SPAA; path=/; expires=Tue, 07-Oct-25 02:14:42 GMT; domain=.x.ai; HttpOnly; Secure; SameSite=None', 'strict-transport-security': 'max-age=31536000', 'server': 'cloudflare', 'cf-ray': '98a9b6682b6538e9-SLC'})
2025-10-06 19:44:42,351 - DEBUG - request_id: 00-696203495e313ffdc9b968c45e944908-c0210bbe000648ea-01
[2025-10-06 19:44:02] DEBUG: Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."},{"type":"Regulatory Compliance - MiCA","severity":"Med","fix":"Ensure contract security aligns with MiCA's requirements for crypto-asset service providers, including robust risk management."},{"type":"Regulatory Compliance - SEC FIT21","severity":"Med","fix":"Address security vulnerabilities to comply with FIT21's emphasis on investor protection and market integrity for digital assets."}],"predictions":[{"scenario":"An attacker exploits reentrancy to drain funds from the contract.","impact":"High"},{"scenario":"Regulatory scrutiny under MiCA leading to non-compliance penalties.","impact":"Med"},{"scenario":"SEC enforcement actions under FIT21 due to insecure token handling.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy.","Conduct a thorough security audit of the smart contract.","Review and update the contract to meet MiCA and FIT21 regulatory standards for 2025."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-06 19:44:42,358 - INFO - Raw Grok Response:  {"risk_score":80,"issues":[{"type":"Reentrancy Vulnerability","severity":"High","fix":"Update the balance before sending Ether using the checks-effects-interactions pattern."},{"type":"Regulatory Compliance - MiCA","severity":"Med","fix":"Ensure contract security aligns with MiCA's requirements for crypto-asset service providers, including robust risk management."},{"type":"Regulatory Compliance - SEC FIT21","severity":"Med","fix":"Address security vulnerabilities to comply with FIT21's emphasis on investor protection and market integrity for digital assets."}],"predictions":[{"scenario":"An attacker exploits reentrancy to drain funds from the contract.","impact":"High"},{"scenario":"Regulatory scrutiny under MiCA leading to non-compliance penalties.","impact":"Med"},{"scenario":"SEC enforcement actions under FIT21 due to insecure token handling.","impact":"Med"}],"recommendations":["Implement the checks-effects-interactions pattern to prevent reentrancy.","Conduct a thorough security audit of the smart contract.","Review and update the contract to meet MiCA and FIT21 regulatory standards for 2025."],"remediation_roadmap":null,"fuzzing_results":[]}
2025-10-06 19:44:42,364 - DEBUG - Flushing log file after successful audit
2025-10-06 19:44:42,372 - DEBUG - Retrieved tier for user1: free, audit count: 3
2025-10-06 19:44:42,372 - DEBUG - Flushing log file after tier retrieval
2025-10-06 19:47:07,767 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/create-tier-checkout?username=user1&tier=beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORwig.CkvZuX_ib_0FQMI6zBnPxf1u2C4'})
2025-10-06 19:47:07,767 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:47:07,768 - ERROR - Stripe checkout creation failed for user1 to beginner: No API key provided. (HINT: set your API key using "stripe.api_key = <API-KEY>"). You can generate API keys from the Stripe web interface.  See https://stripe.com/api for details, or email support@stripe.com if you have any questions.
2025-10-06 19:50:14,998 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/create-tier-checkout?username=user1&tier=pro, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORxGw.iT6mq5pq2WfDaw4DYghm281pkqg'})
2025-10-06 19:50:14,998 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:50:14,999 - ERROR - Stripe checkout creation failed for user1 to pro: No API key provided. (HINT: set your API key using "stripe.api_key = <API-KEY>"). You can generate API keys from the Stripe web interface.  See https://stripe.com/api for details, or email support@stripe.com if you have any questions.
2025-10-06 19:50:17,785 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/create-tier-checkout?username=user1&tier=beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORx1g.ItRxFikQ8HLuIs7FL-eEEOgLSgs'})
2025-10-06 19:50:17,785 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:50:17,786 - ERROR - Stripe checkout creation failed for user1 to beginner: No API key provided. (HINT: set your API key using "stripe.api_key = <API-KEY>"). You can generate API keys from the Stripe web interface.  See https://stripe.com/api for details, or email support@stripe.com if you have any questions.
2025-10-06 19:50:20,370 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/create-tier-checkout?username=user1&tier=diamond, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORx2Q.Kmtm3YzZzDhSsJI89km6AIyW_kU'})
2025-10-06 19:50:20,371 - DEBUG - Flushing log file after CSRF verification
2025-10-06 19:50:20,371 - ERROR - Stripe checkout creation failed for user1 to diamond: No API key provided. (HINT: set your API key using "stripe.api_key = <API-KEY>"). You can generate API keys from the Stripe web interface.  See https://stripe.com/api for details, or email support@stripe.com if you have any questions.
2025-10-06 20:13:45,664 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORx3A.96a9sjWSxiDLHJiLLud1QsSgRko'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORx3A.96a9sjWSxiDLHJiLLud1QsSgRko'}
2025-10-06 20:13:45,664 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aORx3A.96a9sjWSxiDLHJiLLud1QsSgRko'})
2025-10-06 20:13:45,665 - DEBUG - Reusing existing CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 20:13:45,665 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 20:13:45,665 - INFO - Returning CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 20:13:45,665 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 20:17:16,846 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-06 20:17:16,846 - DEBUG - Flushing log file after loading UI
2025-10-06 20:17:16,901 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aOR4LA.tAs2QfEo_aA1krOMMwqYKDHpdXg'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aOR4LA.tAs2QfEo_aA1krOMMwqYKDHpdXg'}
2025-10-06 20:17:16,901 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aOR4LA.tAs2QfEo_aA1krOMMwqYKDHpdXg'})
2025-10-06 20:17:16,901 - DEBUG - Reusing existing CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 20:17:16,901 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 20:17:16,901 - INFO - Returning CSRF token: WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY
2025-10-06 20:17:16,901 - DEBUG - Flushing log file after returning CSRF token
2025-10-06 20:17:16,905 - DEBUG - Retrieved tier for user1: free, audit count: 3
2025-10-06 20:17:16,905 - DEBUG - Flushing log file after tier retrieval
2025-10-06 20:17:42,467 - DEBUG - Verifying CSRF token for request: POST http://127.0.0.1:8000/create-tier-checkout?username=user1&tier=beginner, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'content-length': '0', 'sec-ch-ua-platform': '"Windows"', 'x-csrf-token': 'WlIBZZ433wlyZ4aW7o4_JJO3YGqRutuRir6SLbY-oMY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'origin': 'http://127.0.0.1:8000', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIldsSUJaWjQzM3dseVo0YVc3bzRfSkpPM1lHcVJ1dHVSaXI2U0xiWS1vTVkifQ==.aOR4LA.tAs2QfEo_aA1krOMMwqYKDHpdXg'})
2025-10-06 20:17:42,467 - DEBUG - Flushing log file after CSRF verification
2025-10-06 20:17:42,468 - ERROR - Stripe checkout creation failed for user1 to beginner: No API key provided. (HINT: set your API key using "stripe.api_key = <API-KEY>"). You can generate API keys from the Stripe web interface.  See https://stripe.com/api for details, or email support@stripe.com if you have any questions.
2025-10-06 20:47:17,665 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-06 20:47:17,665 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-06 20:47:17,665 - INFO - Generated new CSRF token: lHIzflQ6nX2mUw_hMlm6pBl8GLic1Ga23lyQOIRF9no
2025-10-06 20:47:17,665 - DEBUG - Flushing log file after CSRF token generation
2025-10-06 20:47:17,665 - INFO - Returning CSRF token: lHIzflQ6nX2mUw_hMlm6pBl8GLic1Ga23lyQOIRF9no
2025-10-06 20:47:17,665 - DEBUG - Flushing log file after returning CSRF token
Logging initialized at 2025-10-07 18:45:04
2025-10-07 18:45:04,313 - INFO - Migrating users table to add api_key, audit_history, and has_diamond columns
2025-10-07 18:45:04,342 - INFO - Database migration completed
2025-10-07 18:45:04,351 - INFO - Tier switched to: free
2025-10-07 18:45:04,824 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-07 18:45:04,825 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001A4B905A3C0>
2025-10-07 18:45:04,826 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-07 18:45:05,602 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-07 18:45:05,602 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
Logging initialized at 2025-10-07 18:45:46
2025-10-07 18:45:46,262 - INFO - Tier switched to: free
2025-10-07 18:45:46,749 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-07 18:45:46,750 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001E5B0F86900>
2025-10-07 18:45:46,751 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-07 18:45:47,535 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-07 18:45:47,535 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-07 18:46:05,073 - DEBUG - Root endpoint accessed, redirecting to /ui
2025-10-07 18:46:05,073 - DEBUG - Flushing log file after root access
2025-10-07 18:46:05,138 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-07 18:46:05,138 - DEBUG - Flushing log file after loading UI
2025-10-07 18:46:05,330 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-07 18:46:05,330 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-07 18:46:05,330 - INFO - Generated new CSRF token: Hq4OD4ZxsXrViDcc-h_2RtS_7zSw55KnaRf0FfIKzgE
2025-10-07 18:46:05,330 - DEBUG - Flushing log file after CSRF token generation
2025-10-07 18:46:05,330 - INFO - Returning CSRF token: Hq4OD4ZxsXrViDcc-h_2RtS_7zSw55KnaRf0FfIKzgE
2025-10-07 18:46:05,330 - DEBUG - Flushing log file after returning CSRF token
2025-10-07 18:46:05,335 - DEBUG - No username provided for /tier; returning free tier defaults
2025-10-07 18:46:05,335 - DEBUG - Retrieved tier for anonymous: free, audit count: 0, has_diamond: False
2025-10-07 18:46:05,336 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-07 18:46:27
2025-10-07 18:46:27,317 - INFO - Tier switched to: free
2025-10-07 18:46:27,826 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-07 18:46:27,826 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001EC7BA167B0>
2025-10-07 18:46:27,828 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-07 18:46:28,682 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-07 18:46:28,683 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
2025-10-07 18:46:31,453 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-07 18:46:31,453 - DEBUG - Flushing log file after loading UI
2025-10-07 18:46:31,470 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkhxNE9ENFp4c1hyVmlEY2MtaF8yUnRTXzd6U3c1NUtuYVJmMEZmSUt6Z0UifQ==.aOW0TQ.Qpgq79VcCXC_Tu8lWPFOIHnvO4c'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIkhxNE9ENFp4c1hyVmlEY2MtaF8yUnRTXzd6U3c1NUtuYVJmMEZmSUt6Z0UifQ==.aOW0TQ.Qpgq79VcCXC_Tu8lWPFOIHnvO4c'}
2025-10-07 18:46:31,470 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIkhxNE9ENFp4c1hyVmlEY2MtaF8yUnRTXzd6U3c1NUtuYVJmMEZmSUt6Z0UifQ==.aOW0TQ.Qpgq79VcCXC_Tu8lWPFOIHnvO4c'})
2025-10-07 18:46:31,470 - INFO - Generated new CSRF token: UYpyC2T56jloxetFF5LPjnDsDtQvcWmrm9wV-exEDPo
2025-10-07 18:46:31,470 - DEBUG - Flushing log file after CSRF token generation
2025-10-07 18:46:31,470 - INFO - Returning CSRF token: UYpyC2T56jloxetFF5LPjnDsDtQvcWmrm9wV-exEDPo
2025-10-07 18:46:31,470 - DEBUG - Flushing log file after returning CSRF token
2025-10-07 18:46:31,485 - DEBUG - No username provided for /tier; returning free tier defaults
2025-10-07 18:46:31,485 - DEBUG - Retrieved tier for anonymous: free, audit count: 0, has_diamond: False
2025-10-07 18:46:31,485 - DEBUG - Flushing log file after tier retrieval
2025-10-07 18:46:33,010 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-07 18:46:33,010 - DEBUG - Flushing log file after loading UI
2025-10-07 18:46:33,036 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlVZcHlDMlQ1Nmpsb3hldEZGNUxQam5Ec0R0UXZjV21ybTl3Vi1leEVEUG8ifQ==.aOW0aQ.clP7yoDzSncvluxe5dxb9J4ZKkU'}), cookies: {'session': 'eyJjc3JmX3Rva2VuIjogIlVZcHlDMlQ1Nmpsb3hldEZGNUxQam5Ec0R0UXZjV21ybTl3Vi1leEVEUG8ifQ==.aOW0aQ.clP7yoDzSncvluxe5dxb9J4ZKkU'}
2025-10-07 18:46:33,036 - DEBUG - Processing get_csrf_token for session: {'csrf_token': 'UYpyC2T56jloxetFF5LPjnDsDtQvcWmrm9wV-exEDPo'}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9', 'cookie': 'session=eyJjc3JmX3Rva2VuIjogIlVZcHlDMlQ1Nmpsb3hldEZGNUxQam5Ec0R0UXZjV21ybTl3Vi1leEVEUG8ifQ==.aOW0aQ.clP7yoDzSncvluxe5dxb9J4ZKkU'})
2025-10-07 18:46:33,036 - DEBUG - Reusing existing CSRF token: UYpyC2T56jloxetFF5LPjnDsDtQvcWmrm9wV-exEDPo
2025-10-07 18:46:33,036 - DEBUG - Flushing log file after CSRF token generation
2025-10-07 18:46:33,036 - INFO - Returning CSRF token: UYpyC2T56jloxetFF5LPjnDsDtQvcWmrm9wV-exEDPo
2025-10-07 18:46:33,036 - DEBUG - Flushing log file after returning CSRF token
2025-10-07 18:46:33,039 - DEBUG - No username provided for /tier; returning free tier defaults
2025-10-07 18:46:33,039 - DEBUG - Retrieved tier for anonymous: free, audit count: 0, has_diamond: False
2025-10-07 18:46:33,040 - DEBUG - Flushing log file after tier retrieval
2025-10-07 18:47:01,778 - INFO - Loading UI from: C:\Users\client\DeFiGuard\templates\index.html
2025-10-07 18:47:01,778 - DEBUG - Flushing log file after loading UI
2025-10-07 18:47:01,904 - DEBUG - Received /csrf-token request from 127.0.0.1, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'}), cookies: {}
2025-10-07 18:47:01,905 - DEBUG - Processing get_csrf_token for session: {}, headers: Headers({'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'cache-control': 'no-cache', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="140", "Not=A?Brand";v="24", "Google Chrome";v="140"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://127.0.0.1:8000/ui', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'en-US,en;q=0.9'})
2025-10-07 18:47:01,905 - INFO - Generated new CSRF token: Ws-f7kAJDlUFa1PqmSMNFciZySFlX2FM5a0jO2siuMM
2025-10-07 18:47:01,905 - DEBUG - Flushing log file after CSRF token generation
2025-10-07 18:47:01,905 - INFO - Returning CSRF token: Ws-f7kAJDlUFa1PqmSMNFciZySFlX2FM5a0jO2siuMM
2025-10-07 18:47:01,905 - DEBUG - Flushing log file after returning CSRF token
2025-10-07 18:47:01,908 - DEBUG - No username provided for /tier; returning free tier defaults
2025-10-07 18:47:01,908 - DEBUG - Retrieved tier for anonymous: free, audit count: 0, has_diamond: False
2025-10-07 18:47:01,908 - DEBUG - Flushing log file after tier retrieval
Logging initialized at 2025-10-07 18:59:24
2025-10-07 18:59:24,956 - INFO - Tier switched to: free
2025-10-07 18:59:25,571 - DEBUG - Making request HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion
2025-10-07 18:59:25,571 - DEBUG - Session cached: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, <requests.sessions.Session object at 0x000001E736A667B0>
2025-10-07 18:59:25,573 - DEBUG - Starting new HTTPS connection (1): mainnet.infura.io:443
2025-10-07 18:59:26,445 - DEBUG - https://mainnet.infura.io:443 "POST /v3/ca54310c88734cd58fa7adb19e8d2af9 HTTP/1.1" 200 86
2025-10-07 18:59:26,445 - DEBUG - Getting response HTTP. URI: https://mainnet.infura.io/v3/ca54310c88734cd58fa7adb19e8d2af9, Method: web3_clientVersion, Response: {'jsonrpc': '2.0', 'id': 0, 'result': 'Geth/v1.16.3-stable-d818a9af/linux-arm64/go1.24.6'}
Logging initialized at 2025-10-07 23:47:34
Logging initialized at 2025-10-08 00:09:09
